 TakeOrderedAndProject [COMET: ]
+- Project
   +- Window
      +- CometColumnarToRow
         +- CometSort
            +- CometColumnarExchange
               +-  HashAggregate [COMET: Unsupported result expressions found in: List((MakeDecimal(sum(UnscaledValue(ss_net_profit#1))#2,17,2) / MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#4,17,2)) AS gross_margin#5, i_category#6, i_class#7, (cast((shiftright(spark_grouping_id#8, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8, 0) & 1) as tinyint)) AS lochierarchy#9, (MakeDecimal(sum(UnscaledValue(ss_net_profit#1))#2,17,2) / MakeDecimal(sum(UnscaledValue(ss_ext_sales_price#3))#4,17,2)) AS _w0#10, (cast((shiftright(spark_grouping_id#8, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8, 0) & 1) as tinyint)) AS _w1#11, CASE WHEN (cast((shiftright(spark_grouping_id#8, 0) & 1) as tinyint) = 0) THEN i_category#6 END AS _w2#12)]
                  +- CometColumnarToRow
                     +- CometExchange
                        +- CometHashAggregate
                           +- CometExpand
                              +- CometProject
                                 +- CometBroadcastHashJoin
                                    :- CometProject
                                    :  +- CometBroadcastHashJoin
                                    :     :- CometProject
                                    :     :  +- CometBroadcastHashJoin
                                    :     :     :- CometFilter
                                    :     :     :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                    :     :     :        +- SubqueryBroadcast
                                    :     :     :           +- BroadcastExchange
                                    :     :     :              +- CometColumnarToRow
                                    :     :     :                 +- CometProject
                                    :     :     :                    +- CometFilter
                                    :     :     :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                    :     :     +- CometBroadcastExchange
                                    :     :        +- CometProject
                                    :     :           +- CometFilter
                                    :     :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                    :     +- CometBroadcastExchange
                                    :        +- CometProject
                                    :           +- CometFilter
                                    :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.item
                                    +- CometBroadcastExchange
                                       +- CometProject
                                          +- CometFilter
                                             +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store

Comet accelerated 28 out of 34 eligible operators (82%). Final plan contains 3 transitions between Spark and Comet.