 TakeOrderedAndProject [COMET: ]
+- Project
   +- Window
      +- CometColumnarToRow
         +- CometSort
            +- CometColumnarExchange
               +- HashAggregate
                  +- CometColumnarToRow
                     +- CometColumnarExchange
                        +- HashAggregate
                           +- Expand
                              +- Project
                                 +- BroadcastHashJoin
                                    :- CometColumnarToRow
                                    :  +- CometProject
                                    :     +- CometBroadcastHashJoin
                                    :        :- CometFilter
                                    :        :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                    :        :        +- SubqueryBroadcast
                                    :        :           +- BroadcastExchange
                                    :        :              +- CometColumnarToRow
                                    :        :                 +- CometProject
                                    :        :                    +- CometFilter
                                    :        :                       +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                    :        +- CometBroadcastExchange
                                    :           +- CometProject
                                    :              +- CometFilter
                                    :                 +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim
                                    +- BroadcastExchange
                                       +- Project
                                          +- BroadcastHashJoin
                                             :- CometColumnarToRow
                                             :  +- CometFilter
                                             :     +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                                             +- BroadcastExchange
                                                +- Project
                                                   +- Filter
                                                      +- Window
                                                         +-  WindowGroupLimit [COMET: WindowGroupLimit is not supported]
                                                            +- Sort
                                                               +-  HashAggregate [COMET: makedecimal is not supported, Unsupported result expressions found in: List(s_state#1, MakeDecimal(sum(UnscaledValue(ss_net_profit#2))#3,17,2) AS _w0#4, s_state#1)]
                                                                  +- CometColumnarToRow
                                                                     +- CometExchange
                                                                        +- CometHashAggregate
                                                                           +- CometProject
                                                                              +- CometBroadcastHashJoin
                                                                                 :- CometProject
                                                                                 :  +- CometBroadcastHashJoin
                                                                                 :     :- CometFilter
                                                                                 :     :  +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store_sales
                                                                                 :     :        +- ReusedSubquery
                                                                                 :     +- CometBroadcastExchange
                                                                                 :        +- CometProject
                                                                                 :           +- CometFilter
                                                                                 :              +- CometScan [native_iceberg_compat] parquet spark_catalog.default.store
                                                                                 +- CometBroadcastExchange
                                                                                    +- CometProject
                                                                                       +- CometFilter
                                                                                          +- CometScan [native_iceberg_compat] parquet spark_catalog.default.date_dim

Comet accelerated 32 out of 53 eligible operators (60%). Final plan contains 6 transitions between Spark and Comet.